(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1035:function(e,t){},1117:function(e,t){},1119:function(e,t){},1125:function(e,t){},1127:function(e,t){},1158:function(e,t){},1160:function(e,t){},1161:function(e,t){},1167:function(e,t){},1169:function(e,t){},1187:function(e,t){},1190:function(e,t){},1207:function(e,t){},1210:function(e,t){},1258:function(e,t){},1342:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"toggleDrawerOpen",function(){return Wt});var r={};n.r(r),n.d(r,"storeUserLocation",function(){return Ft}),n.d(r,"centerOnUser",function(){return Zt}),n.d(r,"centerOnUnit",function(){return Pt});var c={};n.r(c),n.d(c,"handleDeviceUpdate",function(){return an}),n.d(c,"getDevices",function(){return rn}),n.d(c,"init",function(){return cn}),n.d(c,"getHour",function(){return on});var o={};n.r(o),n.d(o,"setDate",function(){return En}),n.d(o,"setHour",function(){return kn}),n.d(o,"setMeasurement",function(){return xn}),n.d(o,"selectUnit",function(){return wn}),n.d(o,"unselectUnit",function(){return In}),n.d(o,"toggleMode",function(){return Sn});var i={};n.r(i),n.d(i,"createSnapshots",function(){return Nn});var s={};n.r(s),n.d(s,"signOut",function(){return Qn}),n.d(s,"updateOadaDomain",function(){return Kn}),n.d(s,"connect",function(){return $n}),n.d(s,"setConnection",function(){return ea});var u={};n.r(u),n.d(u,"init",function(){return ra});var l=n(1),d=n.n(l),p=n(50),b=n(24),f=n(4),O=n(36),m=n(37),j=n(39),h=n(38),v=n(40),g=n(33),y=n(3),E=n(223),k=n.n(E),x=n(340),w=n(171),I=n.n(w),S=n(133),U=n.n(S),_=n(219),C=n.n(_),D=n(559),M=n.n(D),N=n(560),L=n.n(N);function R(){var e=Object(f.a)(["session.toggleDrawerOpen"]);return R=function(){return e},e}function W(){var e=Object(f.a)(["map.centerOnUser"]);return W=function(){return e},e}function G(){var e=Object(f.a)(["map.userLocationAvailable"]);return G=function(){return e},e}var X=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.classes;return e=this.props.userLocationAvailable?d.a.createElement(I.a,{onClick:function(){return t.props.centerOnUser({})}},d.a.createElement(M.a,{className:n.icon})):null,d.a.createElement(C.a,null,d.a.createElement(I.a,{color:"inherit","aria-label":"Open Drawer",onClick:function(){return t.props.toggleDrawerOpen({})}},d.a.createElement(L.a,{className:n.icon})),d.a.createElement(U.a,{variant:"h6",color:"inherit",className:n.flex},"ISOBlueApp [1.1.2]"),e)}}]),t}(d.a.Component),J=Object(g.connect)({userLocationAvailable:Object(y.state)(G()),centerOnUser:Object(y.signal)(W()),toggleDrawerOpen:Object(y.signal)(R())},Object(b.withStyles)(function(e){var t;return{flex:{flex:1},icon:(t={color:"#FFFFFF"},Object(x.a)(t,e.breakpoints.up("xs"),{width:5*e.spacing.unit,height:5*e.spacing.unit,marginRight:e.spacing.unit}),Object(x.a)(t,e.breakpoints.down("xs"),{width:4*e.spacing.unit,height:4*e.spacing.unit,marginRight:e.spacing.unit}),t)}})(X)),V=n(1347),T=n(1348),F=n(1350),Z=(n(759),n(23)),P=n.n(Z),Y=(n(240),n(1345));function A(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return A=function(){return e},e}function H(){var e=Object(f.a)(["diagnostics.hour"]);return H=function(){return e},e}function z(){var e=Object(f.a)(["diagnostics.date"]);return z=function(){return e},e}function B(){var e=Object(f.a)(["oada"]);return B=function(){return e},e}function q(){var e=Object(f.a)(["data.ready"]);return q=function(){return e},e}function Q(){var e=Object(f.a)(["data.connection_id"]);return Q=function(){return e},e}var K=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.connection_id;if(!this.props.ready)return null;var t=[];if(!this.props.oada[e].bookmarks.hasOwnProperty("isoblue"))return null;var n=this.props.oada[e].bookmarks.isoblue["device-index"]||{};if(this.props.selectedUnit&&this.props.date&&this.props.hour){var a=null;try{a=n[this.props.selectedUnit].location["day-index"][this.props.date]["hour-index"][this.props.hour]["sec-index"]}catch(c){return console.error("hmm"),null}var r=[];P.a.forEach(a,function(e){e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")&&e.lat&&e.lng&&r.push([e.lat,e.lng])}),t.push({unit:this.props.selectedUnit,positions:r})}else P.a.forEach(n,function(e,n){if(e.hasOwnProperty("location")&&e.location.hasOwnProperty("day-index")){var a=Object.keys(e.location["day-index"]);if(0!==a.length){var r=P.a.maxBy(a,function(e){return new Date(e)});if(e.location["day-index"][r].hasOwnProperty("hour-index")){var c=Object.keys(e.location["day-index"][r]["hour-index"]),o=P.a.max(c),i=P.a.max(P.a.remove(c,function(e){return e!==o})),s=Math.round((new Date).getTime()/1e3),u=[];if(void 0!==i&&e.location["day-index"][r]["hour-index"][i].hasOwnProperty("sec-index")){var l=e.location["day-index"][r]["hour-index"][i]["sec-index"];Object.keys(l||{}).forEach(function(e){s-e<=900&&l[e].hasOwnProperty("lat")&&l[e].hasOwnProperty("lng")&&l[e].lat&&l[e].lng&&u.push([l[e].lat,l[e].lng])})}if(e.location["day-index"][r]["hour-index"][o].hasOwnProperty("sec-index")){var d=e.location["day-index"][r]["hour-index"][o]["sec-index"];Object.keys(d||{}).forEach(function(e){s-e<=900&&d[e].hasOwnProperty("lat")&&d[e].hasOwnProperty("lng")&&d[e].lat&&d[e].lng&&u.push([d[e].lat,d[e].lng])})}t.push({unit:n,positions:u})}}}});return d.a.createElement("div",null,t.map(function(e){return d.a.createElement(Y.a,{key:e.unit,positions:e.positions,color:"#ffffff"})}))}}]),t}(d.a.Component),$=Object(g.connect)({connection_id:Object(y.state)(Q()),ready:Object(y.state)(q()),oada:Object(y.state)(B()),date:Object(y.state)(z()),hour:Object(y.state)(H()),selectedUnit:Object(y.state)(A())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(K)),ee=n(1346),te=n(1349);function ne(){var e=Object(f.a)(["diagnostics.selectUnit"]);return ne=function(){return e},e}function ae(){var e=Object(f.a)(["snapshots"]);return ae=function(){return e},e}var re=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=[];return P.a.forEach(Object.keys(this.props.snapshots)||{},function(n){var a=e.props.snapshots[n].location;a&&a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")&&a.lat&&a.lng&&t.push(d.a.createElement(ee.a,{ref:function(t){e.unit=t},key:n,center:[e.props.snapshots[n].location.lat,e.props.snapshots[n].location.lng],color:"#ffffff",fillColor:function(){switch(e.props.snapshots[n].health){case"Healthy":return"#008000";case"Sick":return"#ffbf00";case"Down":default:return"#707070"}}(),fillOpacity:1,radius:12,zIndexOffset:1,onClick:function(t){return e.props.selectUnit({unit:n})}},d.a.createElement(te.a,{direction:"top",offset:[0,-10]},d.a.createElement("b",null,"Unit: ",n),d.a.createElement("br",null),d.a.createElement("center",null,d.a.createElement("b",null,e.props.snapshots[n].health)))))}),d.a.createElement("div",null,t)}}]),t}(d.a.Component),ce=Object(g.connect)({snapshots:Object(y.state)(ae()),selectUnit:Object(y.signal)(ne())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(re));function oe(){var e=Object(f.a)(["diagnostics.selectUnit"]);return oe=function(){return e},e}function ie(){var e=Object(f.a)(["map.storeUserLocation"]);return ie=function(){return e},e}function se(){var e=Object(f.a)(["map.userLocationAvailable"]);return se=function(){return e},e}function ue(){var e=Object(f.a)(["map.userLocation"]);return ue=function(){return e},e}function le(){var e=Object(f.a)(["map.targetCenter"]);return le=function(){return e},e}var de=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.refs.map.leafletElement.locate()}},{key:"render",value:function(){var e=this,t=this.props.classes,n=[];return this.props.userLocationAvailable&&n.push(d.a.createElement(V.a,{key:"user",position:[this.props.userLocation.lat,this.props.userLocation.lng]},"zIndexOffset=",1)),d.a.createElement("div",{className:t.map},d.a.createElement(T.a,{dragging:!0,center:[this.props.targetCenter.lat,this.props.targetCenter.lng],ref:"map",zoom:18,onlocationfound:function(t){return e.props.storeUserLocation({lat:t.latlng.lat,lng:t.latlng.lng})},style:{height:"100%",width:"100%",position:"relative"}},d.a.createElement(F.a,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),d.a.createElement(ce,null),d.a.createElement($,null),n))}}]),t}(d.a.Component),pe=Object(g.connect)({targetCenter:Object(y.state)(le()),userLocation:Object(y.state)(ue()),userLocationAvailable:Object(y.state)(se()),storeUserLocation:Object(y.signal)(ie()),selectUnit:Object(y.signal)(oe())},Object(b.withStyles)(function(e){return{map:{position:"relative",display:"flex",width:"100%",height:"calc(100% - 56px)"}}},{withTheme:!0})(de)),be=n(43);function fe(){var e=Object(f.a)(["data"]);return fe=function(){return e},e}function Oe(){var e=Object(f.a)(["oada"]);return Oe=function(){return e},e}function me(){var e=Object(f.a)(["diagnostics.measurement"]);return me=function(){return e},e}function je(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return je=function(){return e},e}function he(){var e=Object(f.a)(["diagnostics.hour"]);return he=function(){return e},e}function ve(){var e=Object(f.a)(["diagnostics.date"]);return ve=function(){return e},e}function ge(){var e=Object(f.a)(["data.connection_id"]);return ge=function(){return e},e}var ye=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e;if(!(this.props.selectedUnit&&this.props.date&&this.props.hour))return null;e=this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit]["day-index"][this.props.date]["hour-index"][this.props.hour];var t,n=[];return"Latency"===this.props.measurement&&e?(P.a.forEach(Object.values(e.heartbeats||{}),function(e){e.latency=e.recTime-e.genTime,e.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(e)}),t=d.a.createElement(be.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(be.b,{type:"step",isAnimationActive:!1,dataKey:"latency",stroke:"#8884d8"}),d.a.createElement(be.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(be.f,{dataKey:"time",label:{value:"Time",position:"insideBottom",dy:20}}),d.a.createElement(be.g,{dataKey:"latency",label:{value:"Latency (sec)",position:"insideLeft",angle:-90}}),d.a.createElement(be.e,null))):"Wifi RSSI"===this.props.measurement&&e?(P.a.forEach(Object.values(e.heartbeats||{}),function(e){P.a.forEach(e.interfaces,function(t){"wifi"===t.type&&(t.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(t))})}),t=d.a.createElement(be.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(be.b,{type:"step",isAnimationActive:!1,dataKey:"rssi",stroke:"#8884d8"}),d.a.createElement(be.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(be.f,{dataKey:"time"}),d.a.createElement(be.g,{dataKey:"rssi",label:{value:"WiFi RSSI (dB)",position:"insideLeft",angle:-90}}),d.a.createElement(be.e,null))):"Cellular RSSI"===this.props.measurement&&e?(P.a.forEach(Object.values(e.heartbeats||{}),function(e){P.a.forEach(e.interfaces,function(t){"cellular"===t.type&&(t.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(t))})}),t=d.a.createElement(be.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(be.b,{type:"step",isAnimationActive:!1,dataKey:"rssi",stroke:"#8884d8"}),d.a.createElement(be.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(be.f,{dataKey:"time"}),d.a.createElement(be.g,{dataKey:"rssi",label:{value:"Cellular RSSI (dB)",position:"insideLeft",angle:-90}}),d.a.createElement(be.e,null))):t=d.a.createElement(be.c,{margin:{top:20,right:30,left:0,bottom:80}}),d.a.createElement(be.d,{width:"100%",height:"100%"},t)}}]),t}(d.a.Component),Ee=Object(g.connect)({connection_id:Object(y.state)(ge()),date:Object(y.state)(ve()),hour:Object(y.state)(he()),selectedUnit:Object(y.state)(je()),measurement:Object(y.state)(me()),oada:Object(y.state)(Oe()),data:Object(y.state)(fe())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(ye));function ke(){var e=Object(f.a)(["diagnostics.mode"]);return ke=function(){return e},e}var xe=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return"map"===this.props.mode?d.a.createElement(pe,null):d.a.createElement(Ee,null)}}]),t}(d.a.Component),we=Object(g.connect)({mode:Object(y.state)(ke())},xe),Ie=n(221),Se=n.n(Ie),Ue=n(96),_e=n.n(Ue),Ce=n(81),De=n.n(Ce),Me=n(48),Ne=n.n(Me),Le=n(220),Re=n.n(Le),We=n(47),Ge=n.n(We),Xe=n(572),Je=n.n(Xe),Ve=n(573),Te=n.n(Ve),Fe=n(344),Ze=n.n(Fe);function Pe(){var e=Object(f.a)(["diagnostics.selectUnit"]);return Pe=function(){return e},e}function Ye(){var e=Object(f.a)(["health"]);return Ye=function(){return e},e}var Ae=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.classes;return e=Object.keys(this.props.health||{}).length>0?d.a.createElement(De.a,{className:n.list,component:"nav"},Object.keys(this.props.health).map(function(e){return d.a.createElement(Ne.a,{button:!0,key:"-".concat(e),onClick:function(){return t.props.selectUnit({unit:e})}},d.a.createElement(Ge.a,{primary:e}),d.a.createElement(Re.a,null,function(){switch(t.props.health[e]){case"Healthy":return d.a.createElement(Je.a,{className:n.healthy});case"Sick":return d.a.createElement(Te.a,{className:n.sick});case"Down":default:return d.a.createElement(Ze.a,null)}}()))})):d.a.createElement(De.a,{className:n.list,component:"nav"}),d.a.createElement(De.a,null,d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"My ISOBlues:"})),e,d.a.createElement(_e.a,null))}}]),t}(d.a.Component),He=Object(g.connect)({health:Object(y.state)(Ye()),selectUnit:Object(y.signal)(Pe())},Object(b.withStyles)(function(e){return{list:{width:"90%",backgroundColor:e.palette.background.paper,overflow:"auto",height:300,margin:1.5*e.spacing.unit},textField:{margin:1.5*e.spacing.unit},healthy:{color:"#008000"},sick:{color:"#ffbf00"},down:{color:"#ff0000"}}})(Ae)),ze=n(82),Be=n.n(ze),qe=n(109),Qe=n.n(qe),Ke=n(136),$e=n.n(Ke);function et(){var e=Object(f.a)(["diagnostics.toggleMode"]);return et=function(){return e},e}function tt(){var e=Object(f.a)(["diagnostics.setMeasurement"]);return tt=function(){return e},e}function nt(){var e=Object(f.a)(["diagnostics.setHour"]);return nt=function(){return e},e}function at(){var e=Object(f.a)(["diagnostics.setDate"]);return at=function(){return e},e}function rt(){var e=Object(f.a)(["diagnostics.unselectUnit"]);return rt=function(){return e},e}function ct(){var e=Object(f.a)(["diagnostics.selectUnit"]);return ct=function(){return e},e}function ot(){var e=Object(f.a)(["data.connection_id"]);return ot=function(){return e},e}function it(){var e=Object(f.a)(["oada"]);return it=function(){return e},e}function st(){var e=Object(f.a)(["diagnostics.mode"]);return st=function(){return e},e}function ut(){var e=Object(f.a)(["data"]);return ut=function(){return e},e}function lt(){var e=Object(f.a)(["snapshots"]);return lt=function(){return e},e}function dt(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return dt=function(){return e},e}function pt(){var e=Object(f.a)(["diagnostics.measurement"]);return pt=function(){return e},e}function bt(){var e=Object(f.a)(["diagnostics.hour"]);return bt=function(){return e},e}function ft(){var e=Object(f.a)(["diagnostics.date"]);return ft=function(){return e},e}var Ot=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this;d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center"},d.a.createElement(Be.a,{onClick:function(){return t.props.toggleMode({})},variant:"contained"},"map"===this.props.mode?"Show Statistics":"Show Map")));e="map"===this.props.mode?["GPS"]:["Latency","Wifi RSSI","Cellular RSSI"];var n=d.a.createElement(Qe.a,{value:this.props.measurement,renderValue:function(e){return"".concat(e)},onChange:function(e){return t.props.setMeasurement({measurement:e.target.value})}},e.map(function(e){return d.a.createElement($e.a,{key:e,value:e},e)})),a=d.a.createElement(Qe.a,{value:this.props.date,renderValue:function(e){return"".concat(e)},onChange:function(e){return t.props.setDate({date:e.target.value})}},Object.keys(this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit].location["day-index"]).map(function(e){return d.a.createElement($e.a,{key:e,value:e},e)}),";"),r=(new Date).getTimezoneOffset(),c=function(e){var t=e.split(":"),n=60*parseInt(t[0])+parseInt(t[1])-r,a="";n<0?(n+=1440,a=" (-1 day)"):n>1440&&(n-=1440,a=" (+1 day)");var c=n%60;return Math.floor(n/60).toString().padStart(2,"0")+":"+c.toString().padStart(2,"0")+a},o=d.a.createElement(Qe.a,{value:this.props.hour,renderValue:function(e){return"".concat(c(e))},onChange:function(e){return t.props.setHour({hour:e.target.value})}},Object.keys(this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit].location["day-index"][this.props.date]["hour-index"]).map(function(e){return d.a.createElement($e.a,{key:e,value:e},c(e))}),";");return d.a.createElement(De.a,null,d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"Selected Unit:"})),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:this.props.selectedUnit})),d.a.createElement(_e.a,null),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"ISOBlue Status:"})),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"Health:"}),d.a.createElement(Ge.a,{align:"center",primary:this.props.snapshots[this.props.selectedUnit].health})),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"Last Report:"}),d.a.createElement(Ge.a,{align:"center",primary:"NA"===this.props.snapshots[this.props.selectedUnit].lastReport?"NA":this.props.snapshots[this.props.selectedUnit].lastLocationReport+" min"})),d.a.createElement(_e.a,null),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center",primary:"Available Data:"})),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center"},n)),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center"},a)),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center"},o)),d.a.createElement(_e.a,null),d.a.createElement(Ne.a,null,d.a.createElement(Ge.a,{align:"center"},d.a.createElement(Be.a,{variant:"contained",onClick:function(){return t.props.unselectUnit({})}},"Back to Main"))))}}]),t}(d.a.Component),mt=Object(g.connect)({date:Object(y.state)(ft()),hour:Object(y.state)(bt()),measurement:Object(y.state)(pt()),selectedUnit:Object(y.state)(dt()),snapshots:Object(y.state)(lt()),data:Object(y.state)(ut()),mode:Object(y.state)(st()),oada:Object(y.state)(it()),connection_id:Object(y.state)(ot()),selectUnit:Object(y.signal)(ct()),unselectUnit:Object(y.signal)(rt()),setDate:Object(y.signal)(at()),setHour:Object(y.signal)(nt()),setMeasurement:Object(y.signal)(tt()),toggleMode:Object(y.signal)(et())},Object(b.withStyles)(function(e){return{}})(Ot));function jt(){var e=Object(f.a)(["session.toggleDrawerOpen"]);return jt=function(){return e},e}function ht(){var e=Object(f.a)(["session.drawerOpen"]);return ht=function(){return e},e}function vt(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return vt=function(){return e},e}var gt=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.classes;return e=this.props.selectedUnit?d.a.createElement(mt,null):d.a.createElement(He,null),d.a.createElement(Se.a,{open:this.props.drawerOpen,onClose:function(){return t.props.toggleDrawerOpen({})},classes:{paper:n.drawerPaper}},d.a.createElement("div",{className:n.toolbar}),e)}}]),t}(d.a.Component),yt=Object(g.connect)({selectedUnit:Object(y.state)(vt()),drawerOpen:Object(y.state)(ht()),toggleDrawerOpen:Object(y.signal)(jt())},Object(b.withStyles)(function(e){return{drawerPaper:{position:"relative",width:240,backgroundColor:"#eeeeee"},toolbar:e.mixins.toolbar}})(gt)),Et=n(141),kt=n(222),xt=n.n(kt);function wt(){var e=Object(f.a)(["connection.updateOadaDomain"]);return wt=function(){return e},e}function It(){var e=Object(f.a)(["connection.setConnection"]);return It=function(){return e},e}function St(){var e=Object(f.a)(["connection.dialog_open"]);return St=function(){return e},e}function Ut(){var e=Object(f.a)(["connection.oada_domain_text"]);return Ut=function(){return e},e}var _t=Object(g.connect)({oadaDomainText:Object(y.state)(Ut()),open:Object(y.state)(St()),submitClicked:Object(y.signal)(It()),oadaDomainChanged:Object(y.signal)(wt())},function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return d.a.createElement(xt.a,{open:this.props.open,className:"connection-dialog"},d.a.createElement(Et.c,{id:"form-dialog-title"},"Connect to OADA Server"),d.a.createElement(Et.b,null,"Please enter the domain of OADA server."),d.a.createElement(Et.b,null,d.a.createElement(Et.d,{autoFocus:!0,label:"Domain",value:this.props.oadaDomainText,onChange:function(t){return e.props.oadaDomainChanged({value:t.target.value})},margin:"dense",fullwidth:"true"})),d.a.createElement(Et.a,null,d.a.createElement(Be.a,{onClick:function(){e.props.open=!1},color:"secondary"},"Cancel"),d.a.createElement(Be.a,{onClick:function(){e.props.submitClicked({})},color:"secondary"},"Submit")))}}]),t}(d.a.Component));function Ct(){var e=Object(f.a)(["init"]);return Ct=function(){return e},e}var Dt=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.props.init({})}},{key:"render",value:function(){var e=this.props.classes;return d.a.createElement("div",{className:e.root},d.a.createElement(k.a,{position:"absolute",className:e.appBar},d.a.createElement(J,null)),d.a.createElement(yt,null),d.a.createElement("main",{className:e.content},d.a.createElement("div",{className:e.toolbar}),d.a.createElement(we,null)),d.a.createElement(_t,null))}}]),t}(d.a.Component),Mt=Object(g.connect)({init:Object(y.signal)(Ct())},Object(b.withStyles)(function(e){return{root:{flexGrow:1,height:"100vh",zIndex:1,overflow:"hidden",position:"relative",display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},content:{flexGrow:1},toolbar:e.mixins.toolbar}},{withTheme:!0})(Dt)),Nt=n(14),Lt=n(16);function Rt(){var e=Object(f.a)(["session.drawerOpen"]);return Rt=function(){return e},e}var Wt=Object(Nt.sequence)("toggleDrawerOpen",[Object(Lt.toggle)(Object(y.state)(Rt()))]),Gt=Object(Nt.Module)({state:{drawerOpen:!1,dataReady:!1},signals:a});function Xt(){var e=Object(f.a)(["map.userLocation"]);return Xt=function(){return e},e}function Jt(){var e=Object(f.a)(["map.targetCenter"]);return Jt=function(){return e},e}function Vt(){var e=Object(f.a)(["map.targetCenter"]);return Vt=function(){return e},e}function Tt(){var e=Object(f.a)(["map.userLocationAvailable"]);return Tt=function(){return e},e}var Ft=Object(Nt.sequence)("storeUserLocation",[function(e){var t=e.state,n=e.props;return t.set("map.userLocation",{lat:n.lat,lng:n.lng})},Object(Lt.set)(Object(y.state)(Tt()),!0)]),Zt=Object(Nt.sequence)("centerOnUser",[Object(Lt.set)(Object(y.state)(Vt()),{lat:40.428641,lng:-86.913783}),Object(Lt.debounce)(1),{continue:[Object(Lt.set)(Object(y.state)(Jt()),Object(y.state)(Xt()))],discard:[]}]),Pt=Object(Nt.sequence)("centerOnUnit",[function(e){var t=e.state,n=(e.props,t.get("data.connection_id")),a=t.get("diagnostics.selectedUnit"),r=t.get("diagnostics.date"),c=t.get("diagnostics.hour");if(a&&r&&c){var o=t.get("oada.".concat(n,".bookmarks.isoblue.device-index.").concat(a,".location.day-index.").concat(r,".hour-index.").concat(c,".sec-index"))||{},i=P.a.max(Object.keys(o));if(i){var s=o[i];s.lat&&s.lng&&t.set("map.targetCenter",s)}}}]),Yt=n(97),At=n.n(Yt);function Ht(){var e=Object(f.a)(["data.ready"]);return Ht=function(){return e},e}function zt(){var e=Object(f.a)(["connection_id"]);return zt=function(){return e},e}function Bt(){var e=Object(f.a)(["data.connection_id"]);return Bt=function(){return e},e}function qt(){var e=Object(f.a)(["health"]);return qt=function(){return e},e}function Qt(){var e=Object(f.a)(["data.ready"]);return Qt=function(){return e},e}function Kt(){var e=Object(f.a)(["data.ready"]);return Kt=function(){return e},e}function $t(){var e=Object(f.a)(["data.ready"]);return $t=function(){return e},e}var en={bookmarks:{_type:"application/vnd.oada.bookmarks.1+json",_rev:0,isoblue:{_type:"application/vnd.oada.isoblue.1+json",_rev:0,"device-index":{"*":{_type:"application/vnd.oada.isoblue.device.1+json",_rev:0,"*":{_type:"application/vnd.oada.isoblue.dataset.1+json",_rev:0,"day-index":{"*":{_type:"application/vnd.oada.isoblue.day.1+json",_rev:0,"hour-index":{"*":{_type:"application/vnd.oada.isoblue.hour.1+json"}}}}}}}}}},tn={bookmarks:{_type:"applications/vnd.oada.bookmarks.1+json",_rev:0,isoblue:{_type:"applications/vnd.oada.isoblue.1+json",_rev:0,"device-index":{"*":{_type:"applications/vnd.oada.isoblue.device.1+json",_rev:0,"*":{_type:"application/vnd.oada.isoblue.dataset.1+json",_rev:0,"day-index":{"*":{_type:"applications/vnd.oada.isoblue.day.1+json",_rev:0}}}}}}}};function nn(e){var t=e.state,n=e.props,a=Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index"))||{}),r=[];return a.forEach(function(e){var a=t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(e,".location.day-index"))||{},c=Object.keys(a);if(0!==c.length){var o=P.a.maxBy(c,function(e){return new Date(e)}),i=P.a.max(Object.keys(a[o]["hour-index"]||{}));r.push({path:"/bookmarks/isoblue/device-index/".concat(e,"/location/day-index/").concat(o,"/hour-index/").concat(i),watch:{signals:["snapshots.createSnapshots"]},tree:en})}}),{requests:r}}var an=Object(Nt.sequence)("data.handleDeviceUpdate",[Object(Lt.set)(Object(y.state)($t()),!1),nn,At.a.get,Object(Lt.set)(Object(y.state)(Kt()),!0)]),rn=Object(Nt.sequence)("data.getDevices",[function(e){e.state,e.props;return{requests:[{path:"/bookmarks/isoblue",tree:tn,watch:{signals:["data.handleDeviceUpdate"]}}]}},At.a.get]),cn=Object(Nt.sequence)("data.init",[Object(Lt.set)(Object(y.state)(Qt()),!1),Object(Lt.set)(Object(y.state)(qt()),{}),Object(Lt.set)(Object(y.state)(Bt()),Object(y.props)(zt())),rn,nn,At.a.get,Object(Lt.set)(Object(y.state)(Ht()),!0)]),on=Object(Nt.sequence)("data.getHour",[function(e){var t=e.state;e.props;return{requests:[{connection_id:t.get("data.connection_id"),path:"/bookmarks/isoblue/device-index/".concat(t.get("diagnostics.selectedUnit"),"/location/day-index/").concat(t.get("diagnostics.date"),"/hour-index/").concat(t.get("diagnostics.hour")),tree:en}]}},At.a.get]);function sn(){var e=Object(f.a)(["diagnostics.measurement"]);return sn=function(){return e},e}function un(){var e=Object(f.a)(["diagnostics.mode"]);return un=function(){return e},e}function ln(){var e=Object(f.a)(["diagnostics.measurement"]);return ln=function(){return e},e}function dn(){var e=Object(f.a)(["diagnostics.mode"]);return dn=function(){return e},e}function pn(){var e=Object(f.a)(["diagnostics.mode"]);return pn=function(){return e},e}function bn(){var e=Object(f.a)(["diagnostics.hour"]);return bn=function(){return e},e}function fn(){var e=Object(f.a)(["diagnostics.date"]);return fn=function(){return e},e}function On(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return On=function(){return e},e}function mn(){var e=Object(f.a)(["unit"]);return mn=function(){return e},e}function jn(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return jn=function(){return e},e}function hn(){var e=Object(f.a)(["hour"]);return hn=function(){return e},e}function vn(){var e=Object(f.a)(["diagnostics.hour"]);return vn=function(){return e},e}function gn(){var e=Object(f.a)(["date"]);return gn=function(){return e},e}function yn(){var e=Object(f.a)(["diagnostics.date"]);return yn=function(){return e},e}var En=Object(Nt.sequence)("setDate",[Object(Lt.set)(Object(y.state)(yn()),Object(y.props)(gn())),function(e){var t=e.state;e.props;return t.set("diagnostics.hour",P.a.max(Object.keys(t.get("oada.".concat(t.get("data.connection_id"),".bookmarks.isoblue.device-index.").concat(t.get("diagnostics.selectedUnit"),".location.day-index.").concat(t.get("diagnostics.date"),".hour-index")))))},on,Pt]),kn=Object(Nt.sequence)("setHour",[Object(Lt.set)(Object(y.state)(vn()),Object(y.props)(hn())),on,Pt]),xn=Object(Nt.sequence)("setMeasurement",[function(e){var t=e.state,n=e.props;return t.set("diagnostics.measurement",n.measurement)}]),wn=Object(Nt.sequence)("selectUnit",[function(e){var t=e.state;e.props;return{connection_id:t.get("data.connection_id")}},Object(Lt.set)(Object(y.state)(jn()),Object(y.props)(mn())),function(e){var t=e.state,n=e.props,a=Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(n.unit,".location.day-index"))).sort(function(e,t){return new Date(t)-new Date(e)})[0],r=P.a.max(Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(n.unit,".location.day-index.").concat(a,".hour-index"))));t.set("diagnostics.date",a),t.set("diagnostics.hour",r)},Pt]),In=Object(Nt.sequence)("unselectUnit",[Object(Lt.set)(Object(y.state)(On()),null),Object(Lt.set)(Object(y.state)(fn()),null),Object(Lt.set)(Object(y.state)(bn()),null)]),Sn=Object(Nt.sequence)("toggleMode",[Object(Lt.when)(Object(y.state)(pn()),function(e){return"map"===e}),{true:[Object(Lt.set)(Object(y.state)(dn()),"graph"),Object(Lt.set)(Object(y.state)(ln()),"Latency")],false:[Object(Lt.set)(Object(y.state)(un()),"map"),Object(Lt.set)(Object(y.state)(sn()),"GPS")]}]),Un=Object(Nt.Module)({state:{hour:null,measurement:"GPS",selectedUnit:null,date:null,mode:"map"},signals:o}),_n=Object(Nt.Module)({state:{targetCenter:{lat:40.428641,lng:-86.913783},userLocation:{lat:40.428641,lng:-86.913783},userLocationAvailable:!1},signals:r}),Cn=Object(Nt.Module)({signals:c});function Dn(){var e=Object(f.a)(["units"]);return Dn=function(){return e},e}function Mn(){var e=Object(f.a)(["snapshots"]);return Mn=function(){return e},e}var Nn=Object(Nt.sequence)("createSnapshots",[function(e){var t=e.state,n=e.props;return{units:P.a.reduce(Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index"))||{}),function(e,a,r){var c=t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(a,".location.day-index")),o=P.a.maxBy(Object.keys(c||{}),function(e){return new Date(e)});if(!o)return e;if(!c[o].hasOwnProperty("hour-index"))return e;var i=P.a.max(Object.keys(c[o]["hour-index"]||{}));if(!i)return e;var s=P.a.max(Object.keys(c[o]["hour-index"][i]["sec-index"]||{}))||null,u=s?c[o]["hour-index"][i]["sec-index"][s]:null;if(u){var l=Math.round((Math.round((new Date).getTime()/1e3)-s)/60),d=null;d=l<2?"Healthy":l<10?"Sick":"Down";var p=null;u.hasOwnProperty("lat")&&u.hasOwnProperty("lng")&&(p=u);e[a]={health:d,connection:null,location:p,lastLocationReport:l,lastHeartbeatTime:l},t.set("health.".concat(a),d)}else e[a]={health:"Down",connection:null,location:null,lastReport:"NA",lastHeartbeatTime:60},t.set("health.".concat(a),"Down");return e},{})}},Object(Lt.set)(Object(y.state)(Mn()),Object(y.props)(Dn()))]),Ln=Object(Nt.Module)({state:{},signals:i}),Rn=n(172),Wn=n.n(Rn);function Gn(){var e=Object(f.a)(["connection.oada_domain_text"]);return Gn=function(){return e},e}function Xn(){var e=Object(f.a)(["connection.oada_domain"]);return Xn=function(){return e},e}function Jn(){var e=Object(f.a)(["connection.dialog_open"]);return Jn=function(){return e},e}function Vn(){var e=Object(f.a)(["connection_id"]);return Vn=function(){return e},e}function Tn(){var e=Object(f.a)(["connection.connection_id"]);return Tn=function(){return e},e}function Fn(){var e=Object(f.a)(["connection_id"]);return Fn=function(){return e},e}function Zn(){var e=Object(f.a)(["data.connection_id"]);return Zn=function(){return e},e}function Pn(){var e=Object(f.a)(["value"]);return Pn=function(){return e},e}function Yn(){var e=Object(f.a)(["connection.oada_domain_text"]);return Yn=function(){return e},e}function An(){var e=Object(f.a)(["Connections.oada_fields_domain_text"]);return An=function(){return e},e}function Hn(){var e=Object(f.a)(["Connections.oada_domain_text"]);return Hn=function(){return e},e}function zn(){var e=Object(f.a)(["Connections.oada_fields_domain"]);return zn=function(){return e},e}function Bn(){var e=Object(f.a)(["Connections.oada_domain"]);return Bn=function(){return e},e}function qn(){var e=Object(f.a)(["Connections.oada_token"]);return qn=function(){return e},e}var Qn=[Object(Lt.set)(Object(y.state)(qn()),""),Object(Lt.set)(Object(y.state)(Bn()),""),Object(Lt.set)(Object(y.state)(zn()),""),Object(Lt.set)(Object(y.state)(Hn()),""),Object(Lt.set)(Object(y.state)(An()),"")],Kn=[Object(Lt.set)(Object(y.state)(Yn()),Object(y.props)(Pn()))],$n=[function(e){return{domain:e.state.get("connection.oada_domain"),options:{redirect:"https://openatk.com/ISOBlueApp/oauth2/redirect.html",metadata:"eyJqa3UiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbS9jZXJ0cyIsImtpZCI6ImtqY1NjamMzMmR3SlhYTEpEczNyMTI0c2ExIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJyZWRpcmVjdF91cmlzIjpbImh0dHBzOi8vb3BlbmF0ay5jb20vSVNPQmx1ZUFwcC9vYXV0aDIvcmVkaXJlY3QuaHRtbCIsImh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9vYXV0aDIvcmVkaXJlY3QuaHRtbCJdLCJ0b2tlbl9lbmRwb2ludF9hdXRoX21ldGhvZCI6InVybjppZXRmOnBhcmFtczpvYXV0aDpjbGllbnQtYXNzZXJ0aW9uLXR5cGU6and0LWJlYXJlciIsImdyYW50X3R5cGVzIjpbImF1dGhvcml6YXRpb25fY29kZSJdLCJyZXNwb25zZV90eXBlcyI6WyJ0b2tlbiIsImNvZGUiLCJpZF90b2tlbiIsImlkX3Rva2VuIHRva2VuIiwiY29kZSBpZF90b2tlbiIsImNvZGUgdG9rZW4iLCJjb2RlIGlkX3Rva2VuIHRva2VuIl0sImNsaWVudF9uYW1lIjoiSVNPQmx1ZSBIZWFsdGggTW9uaXRvciIsImNsaWVudF91cmkiOiJodHRwOi8vb2FkYS5vcGVuYXRrLmNvbS9JU09CbHVlQXBwIiwiY29udGFjdHMiOlsiU2FtIE5vZWwgPHNhbm9lbEBwdXJkdWUuZWR1PiJdLCJqd2tzIjp7ImtleXMiOlt7Imt0eSI6IlJTQSIsIm4iOiJ6YXVaRkJ1TWRsdjFrWWp6VWI0cS1fM200c21GeG5mdzRTWW9hSHE3Y2k4U2N0WTN4ajdyZEFIeWtRcG5RVnJqNktPOG1hSHYtMEJ2VzVNaGNnaXZrdVlzLXpIRXZmWUJlVkJuY3ZIZ09rSlBiYzkxQ3dfaXdPWTdFSFdCOGhNN1ZpTFFWY19EdjBoOG5KeWJCdmhMMDRDSFF0N0NwTXRWWUc2Zm9KWGMzZHE1MmpOUWJCSElaNW03VnoxS3R5em9MY3A4TzJtaGFMcDQ1VXIzQ18xZUd0djhuNU56OWJXX0JoNVhGWWJEeHY3Qm5oWk5JdzFHQ2JqakF3bXRibm5MN0dnZjRDeTYwd1JIbVI0dm9lMjFPSWpvQVNxMmpaMDN4MTJtWHM3SFBJM1lCNHkyOXd2Wk13MmdMek9kVG9ycnFPLXRsbW4xYm9Qa1dLSkpTWG9BdnciLCJlIjoiQVFBQiJ9XX0sInNvZnR3YXJlX2lkIjoiNzY1ZjFlZjctMzExNy00NjhhLTgwYjMtMDExYzQ1MjhkMGExIiwicmVnaXN0cmF0aW9uX3Byb3ZpZGVyIjoiaHR0cHM6Ly9pZGVudGl0eS5vYWRhLWRldi5jb20iLCJpYXQiOjE1NDcxNDYxOTF9.seH7eMsR1218IgEEbiq3T5ASGQAr7vqvy54_Yu8-6TIoAoVfslG-dSYWE2dXZ_P65kElqCKZLizVxyR1732vcFnOdzp6jE_pgpLg-eWZfVnIvNQdGK8Dh-5t1gVbPs1ME-j_GMCb2Un-mpDS8LAw4Nig_r-monjKyKbcPBN6gc4",scope:"oada.isoblue:all"}}},At.a.connect,Object(Lt.set)(Object(y.state)(Zn()),Object(y.props)(Fn())),Object(Lt.set)(Object(y.state)(Tn()),Object(y.props)(Vn())),Object(Lt.set)(Object(y.state)(Jn()),!1)],ea=[Object(Lt.set)(Object(y.state)(Xn()),Object(y.state)(Gn())),$n,cn,Nn];var ta=Object(Nt.Module)({state:{dialog_open:!0,oada_domain_text:"https://oada.openatk.com",oada_domain:"https://oada.openatk.com"},signals:s,providers:{oada:Wn.a}}),na=n(574),aa=n.n(na),ra=Object(Nt.sequence)("init",[]),ca=Object(Nt.Module)({modules:{connection:ta,session:Gt,oada:aa.a,diagnostics:Un,map:_n,data:Cn,snapshots:Ln},signals:u,providers:{oada:Wn.a}}),oa=(n(1343),Object(Nt.Controller)(ca,{devtools:null})),ia=Object(b.createMuiTheme)({typography:{useNextVariants:!0}});Object(p.render)(d.a.createElement(g.Container,{controller:oa},d.a.createElement(b.MuiThemeProvider,{theme:ia},d.a.createElement(Mt,null))),document.getElementById("root"))},320:function(e,t){},669:function(e,t,n){e.exports=n(1342)},759:function(e,t,n){}},[[669,1,2]]]);
//# sourceMappingURL=main.5d54b0eb.chunk.js.map