(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1025:function(e,t){},1027:function(e,t){},1032:function(e,t){},1034:function(e,t){},1065:function(e,t){},1067:function(e,t){},1068:function(e,t){},1074:function(e,t){},1077:function(e,t){},1097:function(e,t){},1100:function(e,t){},1116:function(e,t){},1119:function(e,t){},1160:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"toggleDrawerOpen",function(){return Tt});var r={};n.r(r),n.d(r,"storeUserLocation",function(){return Yt}),n.d(r,"centerOnUser",function(){return At}),n.d(r,"centerOnUnit",function(){return Ht});var c={};n.r(c),n.d(c,"handleDeviceUpdate",function(){return on}),n.d(c,"init",function(){return sn}),n.d(c,"getHour",function(){return un});var i={};n.r(i),n.d(i,"setDate",function(){return xn}),n.d(i,"setHour",function(){return wn}),n.d(i,"setMeasurement",function(){return Un}),n.d(i,"selectUnit",function(){return In}),n.d(i,"unselectUnit",function(){return Sn}),n.d(i,"toggleMode",function(){return _n});var o={};n.r(o),n.d(o,"createSnapshots",function(){return Rn});var s={};n.r(s),n.d(s,"signOut",function(){return $n}),n.d(s,"updateOadaDomain",function(){return ea}),n.d(s,"init",function(){return ta}),n.d(s,"setConnection",function(){return na});var u={};n.r(u),n.d(u,"init",function(){return ia});var l=n(1),d=n.n(l),p=n(47),b=n(22),f=n(4),O=n(34),m=n(35),j=n(37),h=n(36),v=n(38),g=n(31),y=n(3),E=n(190),k=n.n(E),x=n(279),w=n(149),U=n.n(w),I=n(118),S=n.n(I),_=n(185),C=n.n(_),D=n(465),M=n.n(D),N=n(466),L=n.n(N);function R(){var e=Object(f.a)(["session.toggleDrawerOpen"]);return R=function(){return e},e}function W(){var e=Object(f.a)(["map.centerOnUser"]);return W=function(){return e},e}function G(){var e=Object(f.a)(["map.userLocationAvailable"]);return G=function(){return e},e}var T=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.classes;return e=this.props.userLocationAvailable?d.a.createElement(U.a,{onClick:function(){return t.props.centerOnUser({})}},d.a.createElement(M.a,{className:n.icon})):null,d.a.createElement(C.a,null,d.a.createElement(U.a,{color:"inherit","aria-label":"Open Drawer",onClick:this.props.toggleDrawerOpen},d.a.createElement(L.a,{className:n.icon})),d.a.createElement(S.a,{variant:"h6",color:"inherit",className:n.flex},"ISOBlueApp [1.0.0]"),e)}}]),t}(d.a.Component),X=Object(g.connect)({userLocationAvailable:Object(y.state)(G()),centerOnUser:Object(y.signal)(W()),toggleDrawerOpen:Object(y.signal)(R())},Object(b.withStyles)(function(e){var t;return{flex:{flex:1},icon:(t={color:"#FFFFFF"},Object(x.a)(t,e.breakpoints.up("xs"),{width:5*e.spacing.unit,height:5*e.spacing.unit,marginRight:e.spacing.unit}),Object(x.a)(t,e.breakpoints.down("xs"),{width:4*e.spacing.unit,height:4*e.spacing.unit,marginRight:e.spacing.unit}),t)}})(T)),J=n(1164),V=n(1165),P=n(1167),F=(n(664),n(20)),Z=n.n(F),Y=n(186),A=n.n(Y),H=n(1162);function z(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return z=function(){return e},e}function B(){var e=Object(f.a)(["diagnostics.hour"]);return B=function(){return e},e}function q(){var e=Object(f.a)(["diagnostics.date"]);return q=function(){return e},e}function Q(){var e=Object(f.a)(["oada"]);return Q=function(){return e},e}function K(){var e=Object(f.a)(["data.ready"]);return K=function(){return e},e}function $(){var e=Object(f.a)(["data.connection_id"]);return $=function(){return e},e}var ee=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.connection_id;if(!this.props.ready)return null;var t=[],n=this.props.oada[e].bookmarks.isoblue["device-index"]||{};if(this.props.selectedUnit&&this.props.date&&this.props.hour){if(!n.hasOwnProperty(this.props.selectedUnit))return null;if(!n[this.props.selectedUnit].hasOwnProperty("day-index"))return null;if(!n[this.props.selectedUnit]["day-index"].hasOwnProperty(this.props.date))return null;if(!n[this.props.selectedUnit]["day-index"][this.props.date].hasOwnProperty("hour-index"))return null;if(!n[this.props.selectedUnit]["day-index"][this.props.date]["hour-index"].hasOwnProperty(this.props.hour))return null;if(!n[this.props.selectedUnit]["day-index"][this.props.date]["hour-index"][this.props.hour].hasOwnProperty("gps"))return null;var a=n[this.props.selectedUnit]["day-index"][this.props.date]["hour-index"][this.props.hour].gps,r=[];Z.a.forEach(a,function(e){e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")&&e.lat&&e.lng&&r.push([e.lat,e.lng])}),t.push(r)}else Z.a.forEach(n,function(e,n){if(e.hasOwnProperty("day-index")){var a=Object.keys(e["day-index"]);if(0!==a.length){var r=Z.a.maxBy(a,function(e){return new Date(e)});if(e["day-index"][r].hasOwnProperty("hour-index")){var c=Object.keys(e["day-index"][r]["hour-index"]),i=Z.a.max(c),o=Z.a.max(Z.a.remove(c,function(e){return e!==i})),s=Math.round((new Date).getTime()/1e3),u=[];if(void 0!==o&&e["day-index"][r]["hour-index"][o].hasOwnProperty("gps")){var l=e["day-index"][r]["hour-index"][o].gps;Object.keys(l||{}).forEach(function(e){s-e<=900&&l[e].hasOwnProperty("lat")&&l[e].hasOwnProperty("lng")&&l[e].lat&&l[e].lng&&u.push([l[e].lat,l[e].lng])})}if(e["day-index"][r]["hour-index"][i].hasOwnProperty("gps")){var d=e["day-index"][r]["hour-index"][i].gps;Object.keys(d||{}).forEach(function(e){s-e<=900&&d[e].hasOwnProperty("lat")&&d[e].hasOwnProperty("lng")&&d[e].lat&&d[e].lng&&u.push([d[e].lat,d[e].lng])})}t.push(u)}}}});return d.a.createElement("div",null,t.map(function(e){return d.a.createElement(H.a,{key:A.a.v4(),positions:e,color:"#ffffff"})}))}}]),t}(d.a.Component),te=Object(g.connect)({connection_id:Object(y.state)($()),ready:Object(y.state)(K()),oada:Object(y.state)(Q()),date:Object(y.state)(q()),hour:Object(y.state)(B()),selectedUnit:Object(y.state)(z())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(ee)),ne=n(1163),ae=n(1166);function re(){var e=Object(f.a)(["diagnostics.selectUnit"]);return re=function(){return e},e}function ce(){var e=Object(f.a)(["snapshots"]);return ce=function(){return e},e}var ie=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=[];return Z.a.forEach(Object.keys(this.props.snapshots)||{},function(n){var a=e.props.snapshots[n].location;a&&a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")&&a.lat&&a.lng&&t.push(d.a.createElement(ne.a,{ref:function(t){e.unit=t},key:n,center:[e.props.snapshots[n].location.lat,e.props.snapshots[n].location.lng],color:"#ffffff",fillColor:function(){switch(e.props.snapshots[n].health){case"Healthy":return"#008000";case"Sick":return"#ffbf00";case"Down":default:return"#707070"}}(),fillOpacity:1,radius:12,zIndexOffset:1,onClick:function(t){return e.props.selectUnit({unit:n})}},d.a.createElement(ae.a,{direction:"top",offset:[0,-10]},d.a.createElement("b",null,"Unit: ",n),d.a.createElement("br",null),d.a.createElement("center",null,d.a.createElement("b",null,e.props.snapshots[n].health)))))}),d.a.createElement("div",null,t)}}]),t}(d.a.Component),oe=Object(g.connect)({snapshots:Object(y.state)(ce()),selectUnit:Object(y.signal)(re())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(ie));function se(){var e=Object(f.a)(["diagnostics.selectUnit"]);return se=function(){return e},e}function ue(){var e=Object(f.a)(["map.storeUserLocation"]);return ue=function(){return e},e}function le(){var e=Object(f.a)(["map.userLocationAvailable"]);return le=function(){return e},e}function de(){var e=Object(f.a)(["map.userLocation"]);return de=function(){return e},e}function pe(){var e=Object(f.a)(["map.targetCenter"]);return pe=function(){return e},e}var be=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.refs.map.leafletElement.locate()}},{key:"render",value:function(){var e=this,t=this.props.classes,n=[];return this.props.userLocationAvailable&&n.push(d.a.createElement(J.a,{key:"user",position:[this.props.userLocation.lat,this.props.userLocation.lng]},"zIndexOffset=",1)),d.a.createElement("div",{className:t.map},d.a.createElement(V.a,{dragging:!0,center:[this.props.targetCenter.lat,this.props.targetCenter.lng],ref:"map",zoom:18,onlocationfound:function(t){return e.props.storeUserLocation({lat:t.latlng.lat,lng:t.latlng.lng})},style:{height:"100%",width:"100%",position:"relative"}},d.a.createElement(P.a,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),d.a.createElement(oe,null),d.a.createElement(te,null),n))}}]),t}(d.a.Component),fe=Object(g.connect)({targetCenter:Object(y.state)(pe()),userLocation:Object(y.state)(de()),userLocationAvailable:Object(y.state)(le()),storeUserLocation:Object(y.signal)(ue()),selectUnit:Object(y.signal)(se())},Object(b.withStyles)(function(e){return{map:{position:"relative",display:"flex",width:"100%",height:"calc(100% - 56px)"}}},{withTheme:!0})(be)),Oe=n(41);function me(){var e=Object(f.a)(["data"]);return me=function(){return e},e}function je(){var e=Object(f.a)(["oada"]);return je=function(){return e},e}function he(){var e=Object(f.a)(["diagnostics.measurement"]);return he=function(){return e},e}function ve(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return ve=function(){return e},e}function ge(){var e=Object(f.a)(["diagnostics.hour"]);return ge=function(){return e},e}function ye(){var e=Object(f.a)(["diagnostics.date"]);return ye=function(){return e},e}function Ee(){var e=Object(f.a)(["data.connection_id"]);return Ee=function(){return e},e}var ke=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e;if(!(this.props.selectedUnit&&this.props.date&&this.props.hour))return null;e=this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit]["day-index"][this.props.date]["hour-index"][this.props.hour];var t,n=[];return"Latency"===this.props.measurement&&e?(Z.a.forEach(Object.values(e.heartbeats||{}),function(e){e.latency=e.recTime-e.genTime,e.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(e)}),t=d.a.createElement(Oe.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(Oe.b,{type:"step",isAnimationActive:!1,dataKey:"latency",stroke:"#8884d8"}),d.a.createElement(Oe.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(Oe.f,{dataKey:"time",label:{value:"Time",position:"insideBottom",dy:20}}),d.a.createElement(Oe.g,{dataKey:"latency",label:{value:"Latency (sec)",position:"insideLeft",angle:-90}}),d.a.createElement(Oe.e,null))):"Wifi RSSI"===this.props.measurement&&e?(Z.a.forEach(Object.values(e.heartbeats||{}),function(e){Z.a.forEach(e.interfaces,function(t){"wifi"===t.type&&(t.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(t))})}),t=d.a.createElement(Oe.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(Oe.b,{type:"step",isAnimationActive:!1,dataKey:"rssi",stroke:"#8884d8"}),d.a.createElement(Oe.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(Oe.f,{dataKey:"time"}),d.a.createElement(Oe.g,{dataKey:"rssi",label:{value:"WiFi RSSI (dB)",position:"insideLeft",angle:-90}}),d.a.createElement(Oe.e,null))):"Cellular RSSI"===this.props.measurement&&e?(Z.a.forEach(Object.values(e.heartbeats||{}),function(e){Z.a.forEach(e.interfaces,function(t){"cellular"===t.type&&(t.time=new Date(1e3*e.genTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),n.push(t))})}),t=d.a.createElement(Oe.c,{data:n,margin:{top:20,right:30,left:0,bottom:80}},d.a.createElement(Oe.b,{type:"step",isAnimationActive:!1,dataKey:"rssi",stroke:"#8884d8"}),d.a.createElement(Oe.a,{stroke:"#ccc",strokeDasharray:"5 5"}),d.a.createElement(Oe.f,{dataKey:"time"}),d.a.createElement(Oe.g,{dataKey:"rssi",label:{value:"Cellular RSSI (dB)",position:"insideLeft",angle:-90}}),d.a.createElement(Oe.e,null))):t=d.a.createElement(Oe.c,{margin:{top:20,right:30,left:0,bottom:80}}),d.a.createElement(Oe.d,{width:"100%",height:"100%"},t)}}]),t}(d.a.Component),xe=Object(g.connect)({connection_id:Object(y.state)(Ee()),date:Object(y.state)(ye()),hour:Object(y.state)(ge()),selectedUnit:Object(y.state)(ve()),measurement:Object(y.state)(he()),oada:Object(y.state)(je()),data:Object(y.state)(me())},Object(b.withStyles)(function(e){return{}},{withTheme:!0})(ke));function we(){var e=Object(f.a)(["diagnostics.mode"]);return we=function(){return e},e}var Ue=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return"map"===this.props.mode?d.a.createElement(fe,null):d.a.createElement(xe,null)}}]),t}(d.a.Component),Ie=Object(g.connect)({mode:Object(y.state)(we())},Ue),Se=n(188),_e=n.n(Se),Ce=n(85),De=n.n(Ce),Me=n(72),Ne=n.n(Me),Le=n(45),Re=n.n(Le),We=n(187),Ge=n.n(We),Te=n(44),Xe=n.n(Te),Je=n(478),Ve=n.n(Je),Pe=n(479),Fe=n.n(Pe),Ze=n(283),Ye=n.n(Ze);function Ae(){var e=Object(f.a)(["diagnostics.selectUnit"]);return Ae=function(){return e},e}function He(){var e=Object(f.a)(["health"]);return He=function(){return e},e}var ze=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.classes;return e=Object.keys(this.props.health||{}).length>0?d.a.createElement(Ne.a,{className:n.list,component:"nav"},Object.keys(this.props.health).map(function(e){return d.a.createElement(Re.a,{button:!0,key:"-".concat(e),onClick:function(){return t.props.selectUnit({unit:e})}},d.a.createElement(Xe.a,{primary:e}),d.a.createElement(Ge.a,null,function(){switch(t.props.health[e]){case"Healthy":return d.a.createElement(Ve.a,{className:n.healthy});case"Sick":return d.a.createElement(Fe.a,{className:n.sick});case"Down":default:return d.a.createElement(Ye.a,null)}}()))})):d.a.createElement(Ne.a,{className:n.list,component:"nav"}),d.a.createElement(Ne.a,null,d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"My ISOBlues:"})),e,d.a.createElement(De.a,null))}}]),t}(d.a.Component),Be=Object(g.connect)({health:Object(y.state)(He()),selectUnit:Object(y.signal)(Ae())},Object(b.withStyles)(function(e){return{list:{width:"90%",backgroundColor:e.palette.background.paper,overflow:"auto",height:300,margin:1.5*e.spacing.unit},textField:{margin:1.5*e.spacing.unit},healthy:{color:"#008000"},sick:{color:"#ffbf00"},down:{color:"#ff0000"}}})(ze)),qe=n(73),Qe=n.n(qe),Ke=n(97),$e=n.n(Ke),et=n(121),tt=n.n(et);function nt(){var e=Object(f.a)(["diagnostics.toggleMode"]);return nt=function(){return e},e}function at(){var e=Object(f.a)(["diagnostics.setMeasurement"]);return at=function(){return e},e}function rt(){var e=Object(f.a)(["diagnostics.setHour"]);return rt=function(){return e},e}function ct(){var e=Object(f.a)(["diagnostics.setDate"]);return ct=function(){return e},e}function it(){var e=Object(f.a)(["diagnostics.unselectUnit"]);return it=function(){return e},e}function ot(){var e=Object(f.a)(["diagnostics.selectUnit"]);return ot=function(){return e},e}function st(){var e=Object(f.a)(["data.connection_id"]);return st=function(){return e},e}function ut(){var e=Object(f.a)(["oada"]);return ut=function(){return e},e}function lt(){var e=Object(f.a)(["diagnostics.mode"]);return lt=function(){return e},e}function dt(){var e=Object(f.a)(["data"]);return dt=function(){return e},e}function pt(){var e=Object(f.a)(["snapshots"]);return pt=function(){return e},e}function bt(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return bt=function(){return e},e}function ft(){var e=Object(f.a)(["diagnostics.measurement"]);return ft=function(){return e},e}function Ot(){var e=Object(f.a)(["diagnostics.hour"]);return Ot=function(){return e},e}function mt(){var e=Object(f.a)(["diagnostics.date"]);return mt=function(){return e},e}var jt=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this,n=d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center"},d.a.createElement(Qe.a,{onClick:function(){return t.props.toggleMode({})},variant:"contained"},"map"===this.props.mode?"Show Statistics":"Show Map")));e="map"===this.props.mode?["GPS"]:["Latency","Wifi RSSI","Cellular RSSI"];var a=d.a.createElement($e.a,{value:this.props.measurement,renderValue:function(e){return"".concat(e)},onChange:function(e){return t.props.setMeasurement({measurement:e.target.value})}},e.map(function(e){return d.a.createElement(tt.a,{key:e,value:e},e)})),r=d.a.createElement($e.a,{value:this.props.date,renderValue:function(e){return"".concat(e)},onChange:function(e){return t.props.setDate({date:e.target.value})}},Object.keys(this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit]["day-index"]).map(function(e){return d.a.createElement(tt.a,{key:e,value:e},e)}),";"),c=d.a.createElement($e.a,{value:this.props.hour,renderValue:function(e){return"".concat(e)},onChange:function(e){return t.props.setHour({hour:e.target.value})}},Object.keys(this.props.oada[this.props.connection_id].bookmarks.isoblue["device-index"][this.props.selectedUnit]["day-index"][this.props.date]["hour-index"]).map(function(e){return d.a.createElement(tt.a,{key:e,value:e},e)}),";");return d.a.createElement(Ne.a,null,d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"Selected Unit:"})),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:this.props.selectedUnit})),d.a.createElement(De.a,null),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"ISOBlue Status:"})),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"Health:"}),d.a.createElement(Xe.a,{align:"center",primary:this.props.snapshots[this.props.selectedUnit].health})),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"Last Report:"}),d.a.createElement(Xe.a,{align:"center",primary:"NA"===this.props.snapshots[this.props.selectedUnit].lastReport?"NA":this.props.snapshots[this.props.selectedUnit].lastReport+" min"})),d.a.createElement(De.a,null),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center",primary:"Available Data:"})),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center"},a)),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center"},r)),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center"},c)),n,d.a.createElement(De.a,null),d.a.createElement(Re.a,null,d.a.createElement(Xe.a,{align:"center"},d.a.createElement(Qe.a,{variant:"contained",onClick:function(){return t.props.unselectUnit({})}},"Back to Main"))))}}]),t}(d.a.Component),ht=Object(g.connect)({date:Object(y.state)(mt()),hour:Object(y.state)(Ot()),measurement:Object(y.state)(ft()),selectedUnit:Object(y.state)(bt()),snapshots:Object(y.state)(pt()),data:Object(y.state)(dt()),mode:Object(y.state)(lt()),oada:Object(y.state)(ut()),connection_id:Object(y.state)(st()),selectUnit:Object(y.signal)(ot()),unselectUnit:Object(y.signal)(it()),setDate:Object(y.signal)(ct()),setHour:Object(y.signal)(rt()),setMeasurement:Object(y.signal)(at()),toggleMode:Object(y.signal)(nt())},Object(b.withStyles)(function(e){return{}})(jt));function vt(){var e=Object(f.a)(["session.toggleDrawerOpen"]);return vt=function(){return e},e}function gt(){var e=Object(f.a)(["session.drawerOpen"]);return gt=function(){return e},e}function yt(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return yt=function(){return e},e}var Et=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this.props.classes;return e=this.props.selectedUnit?d.a.createElement(ht,null):d.a.createElement(Be,null),d.a.createElement(_e.a,{open:this.props.drawerOpen,onClose:this.props.toggleDrawerOpen,classes:{paper:t.drawerPaper}},d.a.createElement("div",{className:t.toolbar}),e)}}]),t}(d.a.Component),kt=Object(g.connect)({selectedUnit:Object(y.state)(yt()),drawerOpen:Object(y.state)(gt()),toggleDrawerOpen:Object(y.signal)(vt())},Object(b.withStyles)(function(e){return{drawerPaper:{position:"relative",width:240,backgroundColor:"#eeeeee"},toolbar:e.mixins.toolbar}})(Et)),xt=n(126),wt=n(189),Ut=n.n(wt);function It(){var e=Object(f.a)(["connection.updateOadaDomain"]);return It=function(){return e},e}function St(){var e=Object(f.a)(["connection.setConnection"]);return St=function(){return e},e}function _t(){var e=Object(f.a)(["connection.dialog_open"]);return _t=function(){return e},e}function Ct(){var e=Object(f.a)(["connection.oada_domain_text"]);return Ct=function(){return e},e}var Dt=Object(g.connect)({oadaDomainText:Object(y.state)(Ct()),open:Object(y.state)(_t()),submitClicked:Object(y.signal)(St()),oadaDomainChanged:Object(y.signal)(It())},function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return d.a.createElement(Ut.a,{open:this.props.open,className:"connection-dialog"},d.a.createElement(xt.c,{id:"form-dialog-title"},"Connect to OADA Server"),d.a.createElement(xt.b,null,"Please enter the domain of OADA server."),d.a.createElement(xt.b,null,d.a.createElement(xt.d,{autoFocus:!0,label:"Domain",value:this.props.oadaDomainText,onChange:function(t){return e.props.oadaDomainChanged({value:t.target.value})},margin:"dense",fullwidth:"true"})),d.a.createElement(xt.a,null,d.a.createElement(Qe.a,{onClick:function(){e.props.open=!1},color:"secondary"},"Cancel"),d.a.createElement(Qe.a,{onClick:function(){e.props.submitClicked({})},color:"secondary"},"Submit")))}}]),t}(d.a.Component));function Mt(){var e=Object(f.a)(["init"]);return Mt=function(){return e},e}var Nt=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.props.init({})}},{key:"render",value:function(){var e=this.props.classes;return d.a.createElement("div",{className:e.root},d.a.createElement(k.a,{position:"absolute",className:e.appBar},d.a.createElement(X,null)),d.a.createElement(kt,null),d.a.createElement("main",{className:e.content},d.a.createElement("div",{className:e.toolbar}),d.a.createElement(Ie,null)),d.a.createElement(Dt,null))}}]),t}(d.a.Component),Lt=Object(g.connect)({init:Object(y.signal)(Mt())},Object(b.withStyles)(function(e){return{root:{flexGrow:1,height:"100vh",zIndex:1,overflow:"hidden",position:"relative",display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},content:{flexGrow:1},toolbar:e.mixins.toolbar}},{withTheme:!0})(Nt)),Rt=n(13),Wt=n(14);function Gt(){var e=Object(f.a)(["session.drawerOpen"]);return Gt=function(){return e},e}var Tt=Object(Rt.sequence)("toggleDrawerOpen",[Object(Wt.toggle)(Object(y.state)(Gt()))]),Xt=Object(Rt.Module)({state:{drawerOpen:!0},signals:a});function Jt(){var e=Object(f.a)(["map.targetCenter"]);return Jt=function(){return e},e}function Vt(){var e=Object(f.a)(["map.userLocation"]);return Vt=function(){return e},e}function Pt(){var e=Object(f.a)(["map.targetCenter"]);return Pt=function(){return e},e}function Ft(){var e=Object(f.a)(["map.targetCenter"]);return Ft=function(){return e},e}function Zt(){var e=Object(f.a)(["map.userLocationAvailable"]);return Zt=function(){return e},e}var Yt=Object(Rt.sequence)("storeUserLocation",[function(e){var t=e.state,n=e.props;return t.set("map.userLocation",{lat:n.lat,lng:n.lng})},Object(Wt.set)(Object(y.state)(Zt()),!0)]),At=Object(Rt.sequence)("centerOnUser",[Object(Wt.set)(Object(y.state)(Ft()),{lat:40.428641,lng:-86.913783}),Object(Wt.debounce)(1),{continue:[Object(Wt.set)(Object(y.state)(Pt()),Object(y.state)(Vt()))],discard:[]}]),Ht=Object(Rt.sequence)("centerOnUnit",[Object(Wt.set)(Object(y.state)(Jt()),{lat:40.428641,lng:-86.913783}),Object(Wt.debounce)(1),{continue:[function(e){var t=e.state,n=(e.props,t.get("data.connection_id")),a=t.get("diagnostics.selectedUnit"),r=t.get("diagnostics.date"),c=t.get("diagnostics.hour");if(a&&r&&c){var i=t.get("oada.".concat(n,".bookmarks.isoblue.device-index.").concat(a,".day-index.").concat(r,".hour-index.").concat(c,".gps"))||{},o=Z.a.max(Object.keys(i));if(o){var s=i[o];s.lat&&s.lng&&t.set("map.targetCenter",s)}}}],discard:[]}]),zt=n(76),Bt=n.n(zt);function qt(){var e=Object(f.a)(["data.ready"]);return qt=function(){return e},e}function Qt(){var e=Object(f.a)(["connection_id"]);return Qt=function(){return e},e}function Kt(){var e=Object(f.a)(["data.connection_id"]);return Kt=function(){return e},e}function $t(){var e=Object(f.a)(["health"]);return $t=function(){return e},e}function en(){var e=Object(f.a)(["data.ready"]);return en=function(){return e},e}function tn(){var e=Object(f.a)(["data.ready"]);return tn=function(){return e},e}function nn(){var e=Object(f.a)(["data.ready"]);return nn=function(){return e},e}var an={bookmarks:{_type:"applications/vnd.oada.bookmarks.1+json",_rev:"0-0",isoblue:{_type:"applications/vnd.oada.isoblue.1+json",_rev:"0-0","device-index":{"*":{_type:"applications/vnd.oada.isoblue.device.1+json",_rev:"0-0","day-index":{"*":{_type:"applications/vnd.oada.isoblue.day.1+json",_rev:"0-0","hour-index":{"*":{_type:"applications/vnd.oada.isoblue.hour.1+json"}}}}}}}}},rn={bookmarks:{_type:"applications/vnd.oada.bookmarks.1+json",_rev:"0-0",isoblue:{_type:"applications/vnd.oada.isoblue.1+json",_rev:"0-0","device-index":{"*":{_type:"applications/vnd.oada.isoblue.device.1+json",_rev:"0-0","day-index":{"*":{_type:"applications/vnd.oada.isoblue.day.1+json",_rev:"0-0"}}}}}}};function cn(e){var t=e.state,n=e.props,a=Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index"))||{}),r=[];return a.forEach(function(e){var a=t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(e,".day-index"))||{},c=Object.keys(a);if(0!==c.length){var i=Z.a.maxBy(c,function(e){return new Date(e)}),o=Z.a.max(Object.keys(a[i]["hour-index"]||{}));r.push({path:"/bookmarks/isoblue/device-index/".concat(e,"/day-index/").concat(i,"/hour-index/").concat(o),watch:{signals:["snapshots.createSnapshots"]},tree:an})}}),{requests:r}}var on=Object(Rt.sequence)("data.handleDeviceUpdate",[Object(Wt.set)(Object(y.state)(nn()),!1),cn,Bt.a.get,Object(Wt.set)(Object(y.state)(tn()),!0)]),sn=Object(Rt.sequence)("data.init",[Object(Wt.set)(Object(y.state)(en()),!1),Object(Wt.set)(Object(y.state)($t()),{}),Bt.a.connect,Object(Wt.set)(Object(y.state)(Kt()),Object(y.props)(Qt())),function(e){e.state,e.props;return{requests:[{path:"/bookmarks/isoblue",tree:rn,watch:{signals:["data.handleDeviceUpdate"]}}]}},Bt.a.get,cn,Bt.a.get,Object(Wt.set)(Object(y.state)(qt()),!0)]),un=Object(Rt.sequence)("data.getHour",[function(e){var t=e.state;e.props;return{requests:[{connection_id:t.get("data.connection_id"),path:"/bookmarks/isoblue/device-index/".concat(t.get("diagnostics.selectedUnit"),"/day-index/").concat(t.get("diagnostics.date"),"/hour-index/").concat(t.get("diagnostics.hour")),tree:an}]}},Bt.a.get]);function ln(){var e=Object(f.a)(["diagnostics.measurement"]);return ln=function(){return e},e}function dn(){var e=Object(f.a)(["diagnostics.mode"]);return dn=function(){return e},e}function pn(){var e=Object(f.a)(["diagnostics.measurement"]);return pn=function(){return e},e}function bn(){var e=Object(f.a)(["diagnostics.mode"]);return bn=function(){return e},e}function fn(){var e=Object(f.a)(["diagnostics.mode"]);return fn=function(){return e},e}function On(){var e=Object(f.a)(["diagnostics.hour"]);return On=function(){return e},e}function mn(){var e=Object(f.a)(["diagnostics.date"]);return mn=function(){return e},e}function jn(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return jn=function(){return e},e}function hn(){var e=Object(f.a)(["unit"]);return hn=function(){return e},e}function vn(){var e=Object(f.a)(["diagnostics.selectedUnit"]);return vn=function(){return e},e}function gn(){var e=Object(f.a)(["hour"]);return gn=function(){return e},e}function yn(){var e=Object(f.a)(["diagnostics.hour"]);return yn=function(){return e},e}function En(){var e=Object(f.a)(["date"]);return En=function(){return e},e}function kn(){var e=Object(f.a)(["diagnostics.date"]);return kn=function(){return e},e}var xn=Object(Rt.sequence)("setDate",[Object(Wt.set)(Object(y.state)(kn()),Object(y.props)(En())),function(e){var t=e.state;e.props;return t.set("diagnostics.hour",Z.a.max(Object.keys(t.get("oada.".concat(t.get("data.connection_id"),".bookmarks.isoblue.device-index.").concat(t.get("diagnostics.selectedUnit"),".day-index.").concat(t.get("diagnostics.date"),".hour-index")))))},un,Ht]),wn=Object(Rt.sequence)("setHour",[Object(Wt.set)(Object(y.state)(yn()),Object(y.props)(gn())),un,Ht]),Un=Object(Rt.sequence)("setMeasurement",[function(e){var t=e.state,n=e.props;return t.set("diagnostics.measurement",n.measurement)}]),In=Object(Rt.sequence)("selectUnit",[function(e){var t=e.state;e.props;return{connection_id:t.get("data.connection_id")}},Object(Wt.set)(Object(y.state)(vn()),Object(y.props)(hn())),function(e){var t=e.state,n=e.props,a=Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(n.unit,".day-index"))).sort(function(e,t){return new Date(t)-new Date(e)})[0],r=Z.a.max(Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(n.unit,".day-index.").concat(a,".hour-index"))));t.set("diagnostics.date",a),t.set("diagnostics.hour",r)},Ht]),Sn=Object(Rt.sequence)("unselectUnit",[Object(Wt.set)(Object(y.state)(jn()),null),Object(Wt.set)(Object(y.state)(mn()),null),Object(Wt.set)(Object(y.state)(On()),null)]),_n=Object(Rt.sequence)("toggleMode",[Object(Wt.when)(Object(y.state)(fn()),function(e){return"map"===e}),{true:[Object(Wt.set)(Object(y.state)(bn()),"graph"),Object(Wt.set)(Object(y.state)(pn()),"Latency")],false:[Object(Wt.set)(Object(y.state)(dn()),"map"),Object(Wt.set)(Object(y.state)(ln()),"GPS")]}]),Cn=Object(Rt.Module)({state:{hour:null,measurement:"GPS",selectedUnit:null,date:null,mode:"map"},signals:i}),Dn=Object(Rt.Module)({state:{targetCenter:{lat:40.428641,lng:-86.913783},userLocation:{lat:40.428641,lng:-86.913783},userLocationAvailable:!1},signals:r}),Mn=Object(Rt.Module)({signals:c});function Nn(){var e=Object(f.a)(["units"]);return Nn=function(){return e},e}function Ln(){var e=Object(f.a)(["snapshots"]);return Ln=function(){return e},e}var Rn=Object(Rt.sequence)("createSnapshots",[function(e){var t=e.state,n=e.props;return{units:Z.a.reduce(Object.keys(t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index"))),function(e,a,r){var c=t.get("oada.".concat(n.connection_id,".bookmarks.isoblue.device-index.").concat(a,".day-index")),i=Z.a.maxBy(Object.keys(c||{}),function(e){return new Date(e)});if(!i)return e;if(!c[i].hasOwnProperty("hour-index"))return e;var o=Z.a.max(Object.keys(c[i]["hour-index"]||{}));if(!o)return e;var s=Z.a.max(Object.keys(c[i]["hour-index"][o].gps||{}))||null,u=Z.a.max(Object.keys(c[i]["hour-index"][o].heartbeats||{}))||null,l=s?c[i]["hour-index"][o].gps[s]:null,d=u?c[i]["hour-index"][o].heartbeats[u]:null;if(l&&d){var p=Math.round((Math.round((new Date).getTime()/1e3)-Z.a.max([u,s]))/60),b=null;d.hasOwnProperty("recTime")&&d.hasOwnProperty("genTime")&&(b=d.recTime-d.genTime);var f=null;f=p<2?b<20?"Healthy":"Sick":p<10?"Sick":"Down";var O=null;l.hasOwnProperty("lat")&&l.hasOwnProperty("lng")&&(O=l);e[a]={health:f,connection:null,location:O,lastReport:p,lastHeartbeatTime:u},t.set("health.".concat(a),f)}else e[a]={health:"Down",connection:null,location:null,lastReport:"NA",lastHeartbeatTime:u},t.set("health.".concat(a),"Down");return e},{})}},Object(Wt.set)(Object(y.state)(Ln()),Object(y.props)(Nn()))]),Wn=Object(Rt.Module)({state:{},signals:o}),Gn=n(150),Tn=n.n(Gn);function Xn(){var e=Object(f.a)(["connection.oada_domain_text"]);return Xn=function(){return e},e}function Jn(){var e=Object(f.a)(["connection.oada_domain"]);return Jn=function(){return e},e}function Vn(){var e=Object(f.a)(["connection.dialog_open"]);return Vn=function(){return e},e}function Pn(){var e=Object(f.a)(["connection_id"]);return Pn=function(){return e},e}function Fn(){var e=Object(f.a)(["connection.connection_id"]);return Fn=function(){return e},e}function Zn(){var e=Object(f.a)(["connection_id"]);return Zn=function(){return e},e}function Yn(){var e=Object(f.a)(["data.connection_id"]);return Yn=function(){return e},e}function An(){var e=Object(f.a)(["value"]);return An=function(){return e},e}function Hn(){var e=Object(f.a)(["connection.oada_domain_text"]);return Hn=function(){return e},e}function zn(){var e=Object(f.a)(["Connections.oada_fields_domain_text"]);return zn=function(){return e},e}function Bn(){var e=Object(f.a)(["Connections.oada_domain_text"]);return Bn=function(){return e},e}function qn(){var e=Object(f.a)(["Connections.oada_fields_domain"]);return qn=function(){return e},e}function Qn(){var e=Object(f.a)(["Connections.oada_domain"]);return Qn=function(){return e},e}function Kn(){var e=Object(f.a)(["Connections.oada_token"]);return Kn=function(){return e},e}var $n=[Object(Wt.set)(Object(y.state)(Kn()),""),Object(Wt.set)(Object(y.state)(Qn()),""),Object(Wt.set)(Object(y.state)(qn()),""),Object(Wt.set)(Object(y.state)(Bn()),""),Object(Wt.set)(Object(y.state)(zn()),"")],ea=[Object(Wt.set)(Object(y.state)(Hn()),Object(y.props)(An()))],ta=[function(e){var t=e.state;return{domain:t.get("connection.oada_domain"),options:{redirect:"https://openatk.com/ISOBlueApp/oauth2/redirect.html",metadata:"eyJqa3UiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbS9jZXJ0cyIsImtpZCI6ImtqY1NjamMzMmR3SlhYTEpEczNyMTI0c2ExIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJyZWRpcmVjdF91cmlzIjpbImh0dHBzOi8vb3BlbmF0ay5jb20vSVNPQmx1ZUFwcC9vYXV0aDIvcmVkaXJlY3QuaHRtbCIsImh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9vYXV0aDIvcmVkaXJlY3QuaHRtbCJdLCJ0b2tlbl9lbmRwb2ludF9hdXRoX21ldGhvZCI6InVybjppZXRmOnBhcmFtczpvYXV0aDpjbGllbnQtYXNzZXJ0aW9uLXR5cGU6and0LWJlYXJlciIsImdyYW50X3R5cGVzIjpbImF1dGhvcml6YXRpb25fY29kZSJdLCJyZXNwb25zZV90eXBlcyI6WyJ0b2tlbiIsImNvZGUiLCJpZF90b2tlbiIsImlkX3Rva2VuIHRva2VuIiwiY29kZSBpZF90b2tlbiIsImNvZGUgdG9rZW4iLCJjb2RlIGlkX3Rva2VuIHRva2VuIl0sImNsaWVudF9uYW1lIjoiSVNPQmx1ZSBIZWFsdGggTW9uaXRvciIsImNsaWVudF91cmkiOiJodHRwOi8vb2FkYS5vcGVuYXRrLmNvbS9JU09CbHVlQXBwIiwiY29udGFjdHMiOlsiU2FtIE5vZWwgPHNhbm9lbEBwdXJkdWUuZWR1PiJdLCJqd2tzIjp7ImtleXMiOlt7Imt0eSI6IlJTQSIsIm4iOiJ6YXVaRkJ1TWRsdjFrWWp6VWI0cS1fM200c21GeG5mdzRTWW9hSHE3Y2k4U2N0WTN4ajdyZEFIeWtRcG5RVnJqNktPOG1hSHYtMEJ2VzVNaGNnaXZrdVlzLXpIRXZmWUJlVkJuY3ZIZ09rSlBiYzkxQ3dfaXdPWTdFSFdCOGhNN1ZpTFFWY19EdjBoOG5KeWJCdmhMMDRDSFF0N0NwTXRWWUc2Zm9KWGMzZHE1MmpOUWJCSElaNW03VnoxS3R5em9MY3A4TzJtaGFMcDQ1VXIzQ18xZUd0djhuNU56OWJXX0JoNVhGWWJEeHY3Qm5oWk5JdzFHQ2JqakF3bXRibm5MN0dnZjRDeTYwd1JIbVI0dm9lMjFPSWpvQVNxMmpaMDN4MTJtWHM3SFBJM1lCNHkyOXd2Wk13MmdMek9kVG9ycnFPLXRsbW4xYm9Qa1dLSkpTWG9BdnciLCJlIjoiQVFBQiJ9XX0sInNvZnR3YXJlX2lkIjoiNzY1ZjFlZjctMzExNy00NjhhLTgwYjMtMDExYzQ1MjhkMGExIiwicmVnaXN0cmF0aW9uX3Byb3ZpZGVyIjoiaHR0cHM6Ly9pZGVudGl0eS5vYWRhLWRldi5jb20iLCJpYXQiOjE1NDcxNDYxOTF9.seH7eMsR1218IgEEbiq3T5ASGQAr7vqvy54_Yu8-6TIoAoVfslG-dSYWE2dXZ_P65kElqCKZLizVxyR1732vcFnOdzp6jE_pgpLg-eWZfVnIvNQdGK8Dh-5t1gVbPs1ME-j_GMCb2Un-mpDS8LAw4Nig_r-monjKyKbcPBN6gc4",scope:"oada.isoblue:all"},connection_id:t.get("operations.connection_id"),signals:["fields.handleWatchUpdate"]}},Bt.a.connect,Object(Wt.set)(Object(y.state)(Yn()),Object(y.props)(Zn())),Object(Wt.set)(Object(y.state)(Fn()),Object(y.props)(Pn())),Object(Wt.set)(Object(y.state)(Vn()),!1)],na=[Object(Wt.set)(Object(y.state)(Jn()),Object(y.state)(Xn())),ta,sn,Rn];var aa=Object(Rt.Module)({state:{dialog_open:!0,oada_domain_text:"https://oada.openatk.com",oada_domain:"https://oada.openatk.com"},signals:s,providers:{oada:Tn.a}}),ra=n(480),ca=n.n(ra),ia=Object(Rt.sequence)("init",[]),oa=Object(Rt.Module)({modules:{connection:aa,session:Xt,oada:ca.a,diagnostics:Cn,map:Dn,data:Mn,snapshots:Wn},signals:u,providers:{oada:Tn.a}}),sa=(n(1161),Object(Rt.Controller)(oa,{devtools:null})),ua=Object(b.createMuiTheme)({typography:{useNextVariants:!0}});Object(p.render)(d.a.createElement(g.Container,{controller:sa},d.a.createElement(b.MuiThemeProvider,{theme:ua},d.a.createElement(Lt,null))),document.getElementById("root"))},574:function(e,t,n){e.exports=n(1160)},664:function(e,t,n){}},[[574,1,2]]]);
//# sourceMappingURL=main.2ca16b01.chunk.js.map